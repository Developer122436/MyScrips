1
00:00:00,000 --> 00:00:02,001
- [Instructor] Because Excel is so widely used

2
00:00:02,001 --> 00:00:04,003
across almost every industry.

3
00:00:04,003 --> 00:00:06,001
There are many tools to choose from

4
00:00:06,001 --> 00:00:07,008
when working with Python.

5
00:00:07,008 --> 00:00:10,002
Openpyxl is a great all around choice

6
00:00:10,002 --> 00:00:11,008
in that it supports functionality

7
00:00:11,008 --> 00:00:13,008
for almost everything Excel.

8
00:00:13,008 --> 00:00:16,002
So let's jump into our text editor

9
00:00:16,002 --> 00:00:19,002
and get started with a small introduction to workbooks.

10
00:00:19,002 --> 00:00:21,005
Let's import what we're working with in this video.

11
00:00:21,005 --> 00:00:33,007
A workbook module, and a load workbook module.

12
00:00:33,007 --> 00:00:35,001
Once we have that covered,

13
00:00:35,001 --> 00:00:37,002
we can create the two most important objects

14
00:00:37,002 --> 00:00:39,002
when working with openpyxl.

15
00:00:39,002 --> 00:00:41,000
The workbook and worksheet.

16
00:00:41,000 --> 00:00:43,005
We do this by using the workbook command.

17
00:00:43,005 --> 00:00:46,008
We'll create a new variable, wb for workbook

18
00:00:46,008 --> 00:00:51,005
and set it equal to workbook.

19
00:00:51,005 --> 00:00:54,004
All this does is initialize a new workbook object

20
00:00:54,004 --> 00:00:56,000
for us to work with.

21
00:00:56,000 --> 00:00:58,007
Once we have that, we'll set up our worksheet.

22
00:00:58,007 --> 00:01:04,000
So ws for worksheet equals workbook.active.

23
00:01:04,000 --> 00:01:05,009
This just creates a worksheet reference

24
00:01:05,009 --> 00:01:08,007
equal to the active sheet in our current workbook.

25
00:01:08,007 --> 00:01:10,007
To make sense of what these represent,

26
00:01:10,007 --> 00:01:15,005
let's hop on to an Excel document.

27
00:01:15,005 --> 00:01:19,001
Now the workbook object is this all encompassing object

28
00:01:19,001 --> 00:01:20,008
that we use to load and save,

29
00:01:20,008 --> 00:01:22,009
and it contains the worksheets.

30
00:01:22,009 --> 00:01:24,003
You can see the different sheets

31
00:01:24,003 --> 00:01:26,000
down in the bottom-left corner.

32
00:01:26,000 --> 00:01:29,008
Here we have Sheet1 and we can add a new one called Sheet2.

33
00:01:29,008 --> 00:01:32,005
The worksheet is where we access all of our data,

34
00:01:32,005 --> 00:01:35,004
our rows, columns or specific cells.

35
00:01:35,004 --> 00:01:37,007
For now I'll show you how to create new worksheets

36
00:01:37,007 --> 00:01:42,004
so let's head back to our Python document.

37
00:01:42,004 --> 00:01:44,009
We can create new worksheets to add multiple pages

38
00:01:44,009 --> 00:01:48,006
of data, we do this by calling the create sheet function

39
00:01:48,006 --> 00:01:50,005
on our workbook object.

40
00:01:50,005 --> 00:01:53,001
So we'll make two new sheets, worksheet one,

41
00:01:53,001 --> 00:01:57,001
and worksheet two.

42
00:01:57,001 --> 00:02:00,002
Then we just set them equal to our create sheet function

43
00:02:00,002 --> 00:02:04,008
on workbook, and now we have to give it a name.

44
00:02:04,008 --> 00:02:07,006
We'll just call this NewSheet.

45
00:02:07,006 --> 00:02:14,004
We'll do the same process for the second worksheet.

46
00:02:14,004 --> 00:02:19,000
And call this Another, but we'll add a zero at the end.

47
00:02:19,000 --> 00:02:21,002
All this does is count as an index,

48
00:02:21,002 --> 00:02:23,007
so in the order of our worksheets this one appears

49
00:02:23,007 --> 00:02:25,002
before everything else.

50
00:02:25,002 --> 00:02:27,006
Now on our workbook, we have two more worksheets

51
00:02:27,006 --> 00:02:30,000
that we can work in between and add data to.

52
00:02:30,000 --> 00:02:31,008
The next step is altering the title

53
00:02:31,008 --> 00:02:33,003
of our current worksheet.

54
00:02:33,003 --> 00:02:38,001
We can do this by using the title function.

55
00:02:38,001 --> 00:02:39,007
Now that this is customized,

56
00:02:39,007 --> 00:02:45,003
let's print out our sheet names property of the workbook.

57
00:02:45,003 --> 00:02:52,006
And we'll run that through terminal.

58
00:02:52,006 --> 00:02:55,006
As you can see our workbook contains three worksheets.

59
00:02:55,006 --> 00:03:00,005
Each named how we added them, Another, MySheet and NewSheet.

60
00:03:00,005 --> 00:03:03,007
Another sheet is first because of our index zero,

61
00:03:03,007 --> 00:03:06,004
essentially we have just created two additional pages

62
00:03:06,004 --> 00:03:09,007
to work with on Excel, one cool optimization tidbit

63
00:03:09,007 --> 00:03:12,003
is that openpyxl won't actually create cells

64
00:03:12,003 --> 00:03:15,005
on your worksheet as objects until they're accessed.

65
00:03:15,005 --> 00:03:18,002
So creating and writing a new workbook like this

66
00:03:18,002 --> 00:03:19,008
doesn't take too much memory.

67
00:03:19,008 --> 00:03:22,004
Now let's look at loading an existing workbook

68
00:03:22,004 --> 00:03:24,000
to access its cells.

69
00:03:24,000 --> 00:03:26,005
All we have to do is use the load workbook function.

70
00:03:26,005 --> 00:03:28,006
So I'll create a workbook variable

71
00:03:28,006 --> 00:03:37,000
called workbook two and load in an existing Excel file.

72
00:03:37,000 --> 00:03:39,004
I'll also add a new worksheet to this workbook

73
00:03:39,004 --> 00:03:41,002
like we did for the last workbook,

74
00:03:41,002 --> 00:03:50,006
but this time using the workbook two variable.

75
00:03:50,006 --> 00:03:56,008
Now let's grab the active sheet of our workbook.

76
00:03:56,008 --> 00:03:58,009
At this point we can start accessing cells,

77
00:03:58,009 --> 00:04:02,001
in an Excel spreadsheet cell objects are indexed

78
00:04:02,001 --> 00:04:05,004
by their column value which is typically A through Z

79
00:04:05,004 --> 00:04:07,007
and their row value which starts at one.

80
00:04:07,007 --> 00:04:10,005
Now if we remember our worksheet is the object

81
00:04:10,005 --> 00:04:12,009
that contains all of the cell objects.

82
00:04:12,009 --> 00:04:16,002
So if we want to grab the cell in the top left,

83
00:04:16,002 --> 00:04:17,008
we know it should be cell A1

84
00:04:17,008 --> 00:04:20,008
and we need to get it through our worksheet.

85
00:04:20,008 --> 00:04:23,000
Openpyxl makes it easy to access this

86
00:04:23,000 --> 00:04:26,000
by using the column and row name like an index.

87
00:04:26,000 --> 00:04:28,005
So let's create a cell variable just to store it

88
00:04:28,005 --> 00:04:35,008
and set it equal to our active sheet indexed at A1.

89
00:04:35,008 --> 00:04:38,002
Now that we have our cell let's print it through terminal

90
00:04:38,002 --> 00:04:44,007
and see what we get.

91
00:04:44,007 --> 00:04:46,008
You'll notice that we're not printing any value

92
00:04:46,008 --> 00:04:48,006
only the object notation.

93
00:04:48,006 --> 00:04:53,000
We get a cell object in sheet one at the spot A1.

94
00:04:53,000 --> 00:04:56,000
Now this is pretty handy because we can store cells

95
00:04:56,000 --> 00:04:59,004
and objects and openpyxl has many properties of cells

96
00:04:59,004 --> 00:05:02,008
that we can access, for now though we only want to focus

97
00:05:02,008 --> 00:05:09,007
on the value inside the cell, so let's print that.

98
00:05:09,007 --> 00:05:13,001
We see that region is printed, so the cell at A1

99
00:05:13,001 --> 00:05:15,006
must contain a string value for region.

100
00:05:15,006 --> 00:05:17,005
Now let's say we wanted to change the value

101
00:05:17,005 --> 00:05:20,008
of that cell, we only need to index the location again

102
00:05:20,008 --> 00:05:22,008
and set it equal to any value.

103
00:05:22,008 --> 00:05:31,002
So we'll use A1 and set it equal to zero.

104
00:05:31,002 --> 00:05:33,004
Now that that's done we'll save the workbook

105
00:05:33,004 --> 00:05:41,006
with the simple save function and check it out.

106
00:05:41,006 --> 00:05:44,001
Let's run this and navigate to our working directory

107
00:05:44,001 --> 00:05:52,004
and open up this Excel sheet.

108
00:05:52,004 --> 00:05:55,009
We can see that our A1 column has the value zero,

109
00:05:55,009 --> 00:05:58,008
and now we can create our own workbooks, worksheets

110
00:05:58,008 --> 00:06:01,003
and specific cells and modify them.

