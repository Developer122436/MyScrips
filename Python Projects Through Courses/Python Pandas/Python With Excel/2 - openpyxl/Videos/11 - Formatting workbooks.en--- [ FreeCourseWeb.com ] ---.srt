1
00:00:00,001 --> 00:00:01,007
- [Instructor] When presenting large sets of data

2
00:00:01,007 --> 00:00:04,008
to others, it is important to format it in such a way

3
00:00:04,008 --> 00:00:06,007
that is readable and understandable.

4
00:00:06,007 --> 00:00:09,004
If you want to create an Excel that's highly stylized,

5
00:00:09,004 --> 00:00:12,009
appealing, and professional then openpyxl provides

6
00:00:12,009 --> 00:00:14,008
the perfect formatting tools.

7
00:00:14,008 --> 00:00:17,002
In this video I'll go over the basic merge

8
00:00:17,002 --> 00:00:20,003
and unmerge functions as well as editing cell styles

9
00:00:20,003 --> 00:00:22,001
and creating your own named style.

10
00:00:22,001 --> 00:00:24,007
The first step to achieving a highly stylized spreadsheet,

11
00:00:24,007 --> 00:00:26,003
is importing what you need.

12
00:00:26,003 --> 00:00:28,008
Many of these style functions require their own import

13
00:00:28,008 --> 00:00:32,007
and it's a lot to write, so I'll just paste it here.

14
00:00:32,007 --> 00:00:34,004
We're also going to need to import

15
00:00:34,004 --> 00:00:40,001
the basic workbook functions.

16
00:00:40,001 --> 00:00:42,002
The next step is creating our workbook,

17
00:00:42,002 --> 00:00:49,004
and getting our active worksheet.

18
00:00:49,004 --> 00:00:51,008
Now just to show some styling options,

19
00:00:51,008 --> 00:00:53,002
we're going to fill our spreadsheet

20
00:00:53,002 --> 00:00:54,007
with some integer values.

21
00:00:54,007 --> 00:01:00,009
We'll use a loop to do so.

22
00:01:00,009 --> 00:01:04,002
Once we have that, we can access some cells to modify,

23
00:01:04,002 --> 00:01:06,005
our basic merge functions are set up exactly

24
00:01:06,005 --> 00:01:08,001
how you think they should be,

25
00:01:08,001 --> 00:01:11,000
you just invoke your word sheet which holds all the cells

26
00:01:11,000 --> 00:01:16,006
and call the merge cells function.

27
00:01:16,006 --> 00:01:22,003
The same applies for the unmerge function.

28
00:01:22,003 --> 00:01:24,007
Of course you need to specify the range of cells

29
00:01:24,007 --> 00:01:28,003
you want to merge, let's use A1 to B5 as an example.

30
00:01:28,003 --> 00:01:34,008
We simply pass in the slice to the merge functions.

31
00:01:34,008 --> 00:01:37,008
You can also use these functions with a different notation

32
00:01:37,008 --> 00:01:40,008
so that it's more easily accessible to merge with variables.

33
00:01:40,008 --> 00:01:43,000
You simply pass in the start row and column,

34
00:01:43,000 --> 00:01:47,000
as well as the end row and column.

35
00:01:47,000 --> 00:01:50,004
If we wanted to merge from B2 to E5 our start row

36
00:01:50,004 --> 00:01:59,002
would be two, our start column would be two

37
00:01:59,002 --> 00:02:01,009
and our end row and end column would be five.

38
00:02:01,009 --> 00:02:04,004
The one thing to remember about merged cells

39
00:02:04,004 --> 00:02:07,002
is that they're addressed as their top-left cell.

40
00:02:07,002 --> 00:02:11,000
So if I had all these cells merged from B2 to E5

41
00:02:11,000 --> 00:02:13,007
I could save this entire merged cell into a variable

42
00:02:13,007 --> 00:02:20,000
called cell by addressing the B2 position of the worksheet.

43
00:02:20,000 --> 00:02:21,006
Now that we have this cell stored,

44
00:02:21,006 --> 00:02:23,007
let's edit some of its style properties.

45
00:02:23,007 --> 00:02:25,006
First let's change the font.

46
00:02:25,006 --> 00:02:27,001
We won't mess with the type of font,

47
00:02:27,001 --> 00:02:30,002
but let's change the color to red, make it a little bigger

48
00:02:30,002 --> 00:02:32,007
and make it italics, we do this by changing

49
00:02:32,007 --> 00:02:39,005
the cells font property.

50
00:02:39,005 --> 00:02:41,006
Now that we know what the text is going to look like,

51
00:02:41,006 --> 00:02:48,002
let's change the actual value.

52
00:02:48,002 --> 00:02:51,003
Our newly merged cell contains the words merged cell

53
00:02:51,003 --> 00:02:55,006
with the text being red, size being 20 and it's italics.

54
00:02:55,006 --> 00:02:58,003
Next say we want our text to be in the bottom-right

55
00:02:58,003 --> 00:03:00,005
corner of the cell, all we have to do

56
00:03:00,005 --> 00:03:04,007
is change the alignment.

57
00:03:04,007 --> 00:03:07,002
The alignment object takes two parameters.

58
00:03:07,002 --> 00:03:16,000
The horizontal location and the vertical location.

59
00:03:16,000 --> 00:03:17,005
Now let's make the background of the cell

60
00:03:17,005 --> 00:03:20,001
a nice smooth transition from black to white.

61
00:03:20,001 --> 00:03:23,000
To accomplish this we use the cell's fill property.

62
00:03:23,000 --> 00:03:26,001
However we have to use one of the two fill functions

63
00:03:26,001 --> 00:03:28,009
we imported, if we wanted a solid color fill

64
00:03:28,009 --> 00:03:31,003
we could use pattern fill but in order to achieve

65
00:03:31,003 --> 00:03:36,001
a nice transition let's use gradient fill.

66
00:03:36,001 --> 00:03:38,009
For gradient fill we have to specify the color we stop at,

67
00:03:38,009 --> 00:03:40,006
and the color we start at.

68
00:03:40,006 --> 00:03:44,009
In openpyxl and Excel documents colors are encoded

69
00:03:44,009 --> 00:03:48,009
in hexadecimal, in rrggbb format.

70
00:03:48,009 --> 00:03:51,007
This means that the first two values correspond to red,

71
00:03:51,007 --> 00:03:55,000
the second two to green, and the third two to blue.

72
00:03:55,000 --> 00:03:57,003
Not let's say we wanted to start at black.

73
00:03:57,003 --> 00:04:00,002
The hexadecimal encoding for this would be six zeroes

74
00:04:00,002 --> 00:04:03,004
as none of the colors would have value.

75
00:04:03,004 --> 00:04:06,008
Next we want to stop at white, the hexadecimal encoding

76
00:04:06,008 --> 00:04:10,004
for this is six fs, this is because each red,

77
00:04:10,004 --> 00:04:15,000
green, and blue color value are at their highest point.

78
00:04:15,000 --> 00:04:16,007
Now that we've altered this merged cell,

79
00:04:16,007 --> 00:04:22,003
let's save to the workbook.

80
00:04:22,003 --> 00:04:25,007
Now we can quickly run this through our terminal.

81
00:04:25,007 --> 00:04:32,000
Let's navigate to our working directory and check it out.

82
00:04:32,000 --> 00:04:34,004
As you can see all of the changes we specified

83
00:04:34,004 --> 00:04:37,008
are laid out, now it's definitely not the prettiest setup.

84
00:04:37,008 --> 00:04:40,009
But in terms of creating templates and layouts for Excel.

85
00:04:40,009 --> 00:04:42,008
Openpyxl can get the job done,

86
00:04:42,008 --> 00:04:44,006
now let's head back to our Python script

87
00:04:44,006 --> 00:04:46,003
and check out named styles.

88
00:04:46,003 --> 00:04:48,004
Named styles are objects we can create

89
00:04:48,004 --> 00:04:51,003
that store a style so that we can use it multiple times

90
00:04:51,003 --> 00:04:53,001
instead of having to type all that out

91
00:04:53,001 --> 00:04:54,009
like we did for our merged cell.

92
00:04:54,009 --> 00:04:57,003
The first thing we do is initialize our style

93
00:04:57,003 --> 00:05:00,006
we'll call it highlight.

94
00:05:00,006 --> 00:05:06,008
We set this equal to a named style with the name highlight.

95
00:05:06,008 --> 00:05:08,003
Now that this is initialized,

96
00:05:08,003 --> 00:05:10,000
we need to change the properties,

97
00:05:10,000 --> 00:05:16,007
first let's set the font to be bold.

98
00:05:16,007 --> 00:05:19,006
Now in typical highlight fashion we need to darken

99
00:05:19,006 --> 00:05:21,006
the borders and change the fill color.

100
00:05:21,006 --> 00:05:24,006
To create thicker borders we need to create a variable

101
00:05:24,006 --> 00:05:26,003
to hold the style of a side.

102
00:05:26,003 --> 00:05:28,002
We'll make this side have a fixed style

103
00:05:28,002 --> 00:05:35,004
and be black in color.

104
00:05:35,004 --> 00:05:37,002
Once this is done we need to change

105
00:05:37,002 --> 00:05:39,005
our named style's border property.

106
00:05:39,005 --> 00:05:41,008
We do this by specifying for border

107
00:05:41,008 --> 00:05:52,009
and setting each edge equal to our new style.

108
00:05:52,009 --> 00:05:54,006
Now that the border is taken care of,

109
00:05:54,006 --> 00:05:57,006
all we need to do is fill the cell with a solid yellow color

110
00:05:57,006 --> 00:05:59,003
instead of using gradient fill,

111
00:05:59,003 --> 00:06:10,003
we'll use pattern fill.

112
00:06:10,003 --> 00:06:12,007
We'll set our red values and green values to as high

113
00:06:12,007 --> 00:06:15,004
as they can be and have no blue value,

114
00:06:15,004 --> 00:06:19,004
this will give us a nice yellow.

115
00:06:19,004 --> 00:06:23,006
Now say we want to apply this style to every cell diagonally

116
00:06:23,006 --> 00:06:25,002
starting at the H column.

117
00:06:25,002 --> 00:06:27,004
First we need to make a count variable

118
00:06:27,004 --> 00:06:30,007
and set that equal to zero.

119
00:06:30,007 --> 00:06:33,001
Then we create a loop using our worksheet's

120
00:06:33,001 --> 00:06:38,001
iter columns function, we'll set our minimum column

121
00:06:38,001 --> 00:06:44,006
to eight for H and our minimum row to one.

122
00:06:44,006 --> 00:06:46,002
We'll also set our maximums

123
00:06:46,002 --> 00:06:54,000
so that it doesn't get out of hand.

124
00:06:54,000 --> 00:06:56,004
Remember that in our iter cols function column

125
00:06:56,004 --> 00:06:57,005
is stored as a list.

126
00:06:57,005 --> 00:07:00,004
Because of that we can use our counter to index the list

127
00:07:00,004 --> 00:07:03,005
for the rows we want, every time column moves over one

128
00:07:03,005 --> 00:07:13,006
our counter should add one so we move one row down.

129
00:07:13,006 --> 00:07:20,005
Now let's save this workbook,

130
00:07:20,005 --> 00:07:24,000
and run this through terminal.

131
00:07:24,000 --> 00:07:26,001
We can navigate over to our working directory

132
00:07:26,001 --> 00:07:29,005
and check out our edits.

133
00:07:29,005 --> 00:07:31,009
As you can see our highlighted style was applied

134
00:07:31,009 --> 00:07:34,006
for all the cells we intended starting at H

135
00:07:34,006 --> 00:07:38,002
and going only diagonal, now we can use these tools

136
00:07:38,002 --> 00:07:40,008
to create stylized and professional spreadsheets.

